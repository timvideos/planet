{"title":"Hunting the bugs in DVSwitch plugin","created_at":"2014-08-04 00:00:00 UTC","author":"Amanpreet (Porting Flumotion)","content":"<p>With help of thaytan, slomo and mithro, I was able to figure out that the problem mentioned in previous post was that dvswitchsrc doesn’t know any caps, and gdppay needs it. thaytan suggested me to use typefind element that can automatically get the caps. Using this, I could run the pipeline without error using gst-launch but running with flumotion still gives following error:</p>\n\n<div class=\"highlight\"><pre><code class=\"language-python\" data-lang=\"python\"><span class=\"n\">Twisted</span> <span class=\"n\">traceback</span><span class=\"p\">:</span>\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n<span class=\"n\">Failure</span><span class=\"p\">:</span> <span class=\"n\">flumotion</span><span class=\"o\">.</span><span class=\"n\">common</span><span class=\"o\">.</span><span class=\"n\">errors</span><span class=\"o\">.</span><span class=\"n\">GStreamerGstError</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"o\">&lt;</span><span class=\"n\">__main__</span><span class=\"o\">.</span><span class=\"n\">GstDvswitchSrc</span> <span class=\"nb\">object</span> <span class=\"n\">at</span> <span class=\"mh\">0x7f10c8c5f410</span> <span class=\"p\">(</span><span class=\"n\">GstDvswitchSrc</span> <span class=\"n\">at</span> <span class=\"mh\">0x18a7be0</span><span class=\"p\">)</span><span class=\"o\">&gt;</span><span class=\"p\">,</span> <span class=\"n\">GError</span><span class=\"p\">(</span><span class=\"s\">&#39;Internal data flow error.&#39;</span><span class=\"p\">,),</span> <span class=\"s\">&#39;gstbasesrc.c(2865): gst_base_src_loop (): /GstPipeline:pipeline-producer-audio-video/GstDvswitchSrc:src:</span><span class=\"se\">\\n</span><span class=\"s\">streaming task paused, reason not-negotiated (-4)&#39;</span><span class=\"p\">)</span>\n \n<span class=\"n\">DEBUG</span> <span class=\"p\">[</span><span class=\"mi\">19679</span><span class=\"p\">]</span> <span class=\"n\">twisted</span> <span class=\"n\">Aug</span> <span class=\"mo\">04</span> <span class=\"mi\">16</span><span class=\"p\">:</span><span class=\"mi\">52</span><span class=\"p\">:</span><span class=\"mi\">36</span> <span class=\"p\">[</span><span class=\"o\">-</span><span class=\"p\">]</span> <span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n<span class=\"n\">Failure</span><span class=\"p\">:</span> <span class=\"n\">flumotion</span><span class=\"o\">.</span><span class=\"n\">common</span><span class=\"o\">.</span><span class=\"n\">errors</span><span class=\"o\">.</span><span class=\"n\">GStreamerGstError</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"o\">&lt;</span><span class=\"n\">__main__</span><span class=\"o\">.</span><span class=\"n\">GstDvswitchSrc</span> <span class=\"nb\">object</span> <span class=\"n\">at</span> <span class=\"mh\">0x7f10c8c5f410</span> <span class=\"p\">(</span><span class=\"n\">GstDvswitchSrc</span> <span class=\"n\">at</span> <span class=\"mh\">0x18a7be0</span><span class=\"p\">)</span><span class=\"o\">&gt;</span><span class=\"p\">,</span> <span class=\"n\">GError</span><span class=\"p\">(</span><span class=\"s\">&#39;Internal data flow error.&#39;</span><span class=\"p\">,),</span> <span class=\"s\">&#39;gstbasesrc.c(2865): gst_base_src_loop (): /GstPipeline:pipeline-producer-audio-video/GstDvswitchSrc:src:</span><span class=\"se\">\\n</span><span class=\"s\">streaming task paused, reason not-negotiated (-4)&#39;</span><span class=\"p\">)</span></code></pre></div>\n\n<p>This shows that some link is not negotiated somewhere in the pipeline. To find the root of this problem, I got out this <a href=\"http://paste.ubuntu.com/7954475/\">DEBUG log</a>. Now this log gave some insights about what is going on and I find these questions to start with:</p>\n\n<ol>\n  <li>\n    <p>Line 81 – linking src:(any) to typefindelement0:(any) (0/0) with caps “(NULL)”  – Does this mean that caps must be set by dvswitchsrc plugin?</p>\n  </li>\n  <li>\n    <p>Line 119 – no such pad ‘video’ in element “demux”  – Is this causing the problem as pads can’t be linked?</p>\n  </li>\n</ol>\n\n<p>There are various such error, but the failure occus at Line 1373 - ` gstbasetransform.c:2115:gst_base_transform_handle_buffer:<videorate0> warning: not negotiated `</videorate0></p>\n\n<p>So, I’m now going to inspect all these problems and hopefully fix them.</p><div class=\"author\">\n  <span>\n    <i>Originally posted on <a href=\"http://aps-sids.github.io/porting-flumotion\">Porting Flumotion - GSoC '14 Progress Blog</a></i>\n  </span>\n</div>\n"}