{"title":"Porting Overlay Convertor","created_at":"2014-06-21 00:00:00 UTC","author":"Amanpreet (Porting Flumotion)","content":"<p>I started with porting the Overlay Convertor element which is used to add any text or logo over a video feed. This required a lot of work as I had to port Pango and PangoCairo to the new PyGI. I did the changes and tried to create a stream which resulted in these errors:</p>\n\n<div class=\"highlight\"><pre><code class=\"bash\">GStreamer-CRITICAL **: gst_segment_to_running_time: assertion <span class=\"sb\">`</span>segment-&gt;format <span class=\"o\">==</span> format<span class=\"err\">&#39;</span> failed\n\nWARN  <span class=\"o\">[</span>42266<span class=\"o\">]</span> <span class=\"s2\">&quot;overlay-video&quot;</span>                  feedcomponent     Jun 21 05:56:39      element /GstPipeline:pipeline-overlay-video/GstBin:bin0/GstAppSrc:source error Internal data flow error. gstbasesrc.c<span class=\"o\">(</span>2865<span class=\"o\">)</span>: gst_base_src_loop <span class=\"o\">()</span>: /GstPipeline:pipeline-overlay-video/GstBin:bin0/GstAppSrc:source:\nstreaming task paused, reason not-negotiated <span class=\"o\">(</span>-4<span class=\"o\">)</span> <span class=\"o\">(</span>flumotion/component/feedcomponent010.py:260<span class=\"o\">)</span>\nWARN  <span class=\"o\">[</span>42266<span class=\"o\">]</span>                                  twisted           Jun 21 05:56:39      A twisted traceback occurred. <span class=\"o\">(</span>twisted/internet/defer.py:648<span class=\"o\">)</span>\n</code></pre></div>\n\n<div class=\"highlight\"><pre><code class=\"python\"><span class=\"n\">Twisted</span> <span class=\"n\">traceback</span><span class=\"p\">:</span>\n<span class=\"n\">Traceback</span> <span class=\"p\">(</span><span class=\"n\">most</span> <span class=\"n\">recent</span> <span class=\"n\">call</span> <span class=\"n\">last</span><span class=\"p\">):</span>\n<span class=\"n\">Failure</span><span class=\"p\">:</span> <span class=\"n\">flumotion</span><span class=\"o\">.</span><span class=\"n\">common</span><span class=\"o\">.</span><span class=\"n\">errors</span><span class=\"o\">.</span><span class=\"n\">GStreamerGstError</span><span class=\"p\">:</span> <span class=\"p\">(</span><span class=\"o\">&lt;</span><span class=\"n\">__main__</span><span class=\"o\">.</span><span class=\"n\">GstAppSrc</span> <span class=\"nb\">object</span> <span class=\"n\">at</span> <span class=\"mh\">0x2cd8550</span> <span class=\"p\">(</span><span class=\"n\">GstAppSrc</span> <span class=\"n\">at</span> <span class=\"mh\">0x2c60170</span><span class=\"p\">)</span><span class=\"o\">&gt;</span><span class=\"p\">,</span> <span class=\"n\">GError</span><span class=\"p\">(</span><span class=\"s\">&#39;Internal data flow error.&#39;</span><span class=\"p\">,),</span> <span class=\"s\">&#39;gstbasesrc.c(2865): gst_base_src_loop (): /GstPipeline:pipeline-overlay-video/GstBin:bin0/GstAppSrc:source:</span><span class=\"se\">\\n</span><span class=\"s\">streaming task paused, reason not-negotiated (-4)&#39;</span><span class=\"p\">)</span>\n</code></pre></div>\n\n<p>This error seems to be due to change in GstBuffer and Buffers not being pushed to Pads properly. Another reason might be due to a problem with GstBin. Iâ€™ll look further into this error tomorrow.</p><div class=\"author\">\n  <span>\n    <i>Originally posted on <a href=\"http://aps-sids.github.io/porting-flumotion\">Porting Flumotion - GSoC '14 Progress Blog</a></i>\n  </span>\n</div>\n"}