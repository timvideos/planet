{"title":"Week 10 Progress","created_at":"2014-07-28 00:00:00 UTC","author":"Amanpreet (Porting Flumotion)","content":"<p>This week, I was eagerly waiting for some good results so I can post on this blog. I was initially working on porting of DVSwitch flumotion component. The code changes were done but stream was still giving errors that caps aren’t set or stream format is not compatible.</p>\n\n<p>I wasn’t able to fix this after various efforts. Then I realized that this might be due to the fact that decoder was not ported and that missing component might be creating problems. So, I diverted towards porting generic decoder.</p>\n\n<p>Now this decoder code uses a custom plugin ‘synckeeper’. For porting, when I used <code>Gst.Pad.new_from_template()</code> as seen in this <a href=\"https://github.com/aps-sids/flumotion-orig/commit/cf3cfbf09f6e8234d95836b30181ad4ed9e5eddc#diff-9d30e92cb49af87d67d5cb9dea9b6783R71\">diff</a>, it led to a crash. Some research about this issue hinted that this might be a problem due to older python-gi an gobject bindings since I have been working on Ubuntu 12.04 Precise.</p>\n\n<p>This whole idea of working on precise was just a temporary measure and we (me and mithro) realized that this was about time to shift to latest Ubuntu 14.04 Trusty since most of the components are ported.</p>\n\n<p>But there was still one more issue, incompatibility with latest Twisted Python. There was some twisted features used in flumotion core that were deprecated and subsequently removed in newer Twisted versions. Mithro did some work regarding that. He found out a patch by someone that was supposed to fix this issue. With that, along with some other changes, mithro created a modern-twisted branch.</p>\n\n<p>I merged that with my code and was able to run a test audio + video stream successfully on Trusty. There were the following errors though:</p>\n\n<div class=\"highlight\"><pre><code class=\"language-bash\" data-lang=\"bash\">DEBUG <span class=\"o\">[</span>40686<span class=\"o\">]</span> <span class=\"s2\">&quot;/default/http-audio-video&quot;</span>      jobmedium         Jul <span class=\"m\">28</span> 11:33:56      creating ComponentClientFactory <span class=\"o\">(</span>flumotion/job/job.py:285<span class=\"o\">)</span>\nDEBUG <span class=\"o\">[</span>40686<span class=\"o\">]</span> <span class=\"s2\">&quot;/default/http-audio-video&quot;</span>      jobmedium         Jul <span class=\"m\">28</span> 11:33:56 : int<span class=\"o\">()</span> argument must be a string or a number, not <span class=\"s1\">&#39;NoneType&#39;</span>\nTypeError     created ComponentClientFactory &lt;flumotion.component.component.ComponentClientFactory instance at 0x7f6848ac2b00&gt; <span class=\"o\">(</span>flumotion/job/job.py:288<span class=\"o\">)</span>\nDEBUG <span class=\"o\">[</span>40686<span class=\"o\">]</span> <span class=\"s2\">&quot;/default/http-audio-video&quot;</span>      jobmedium         Jul <span class=\"m\">28</span> 11:33:56 : int<span class=\"o\">()</span> argument must be a string or a number, not <span class=\"s1\">&#39;NoneType&#39;</span>\nTypeError: int<span class=\"o\">()</span> argument must be a string or a number, not <span class=\"s1\">&#39;NoneType&#39;</span>\nTypeError     logging in with authenticator &lt;flumotion.twisted.pb.RemoteAuthenticator instance at 0x7f6848c069e0&gt; <span class=\"o\">(</span>flumotion/job/job.py:295<span class=\"o\">)</span>\nINFO  <span class=\"o\">[</span>40686<span class=\"o\">]</span> <span class=\"s2\">&quot;/default/http-audio-video&quot;</span>      jobmedium         Jul <span class=\"m\">28</span> 11:33:56 : int<span class=\"o\">()</span> argument must be a string or a number, not <span class=\"s1\">&#39;NoneType&#39;</span>\n     Connecting to manager localhost:8642 with TCP <span class=\"o\">(</span>flumotion/job/job.py:304<span class=\"o\">)</span>\nLOG   <span class=\"o\">[</span>40686<span class=\"o\">]</span>                                  twisted           Jul <span class=\"m\">28</span> 11:33:56 TypeError: int<span class=\"o\">()</span> argument must be a string or a number, not <span class=\"s1\">&#39;NoneType&#39;</span>\nTypeError: int<span class=\"o\">()</span> argument must be a string or a number, not <span class=\"s1\">&#39;NoneType&#39;</span>\nTypeError      <span class=\"o\">[</span>JobClientBroker,client<span class=\"o\">]</span> Starting factory &lt;flumotion.component.component.ComponentClientFactory instance at 0x7f6848ac2b00&gt;\n <span class=\"o\">(</span>twisted/python/threadable.py:53<span class=\"o\">)</span>\nDEBUG <span class=\"o\">[</span>40686<span class=\"o\">]</span> <span class=\"s2\">&quot;/default/http-audio-video&quot;</span>      jobmedium         Jul <span class=\"m\">28</span> 11:33:56 : int<span class=\"o\">()</span> argument must be a string or a number, not <span class=\"s1\">&#39;NoneType&#39;</span>\nTypeError: int<span class=\"o\">()</span> argument must be a string or a number, not <span class=\"s1\">&#39;NoneType&#39;</span>\nTypeError: int<span class=\"o\">()</span> argument must be a string or a number, not <span class=\"s1\">&#39;NoneType&#39;</span></code></pre></div>\n\n<p>So, from now on, I’m going to tie the loose ends and fix the issues with this and other unported components. With Trusty and latest libraries, hopefully I will be able to fix remaining problems.</p><div class=\"author\">\n  <span>\n    <i>Originally posted on <a href=\"http://aps-sids.github.io/porting-flumotion\">Porting Flumotion - GSoC '14 Progress Blog</a></i>\n  </span>\n</div>\n"}