{"title":"Fsm Changed Fps Did Not","content":"---\ntitle: \"FSM Changed, FPS Did NOT!\"\nkind: article\ncreated_at: 2014-05-30 00:24:00 UTC\nauthor: Ajit (MJPEG Optimisation)\nimage: https://avatars3.githubusercontent.com/u/7080716?s=50\ncategories: GSoC-2014-HDMI2USB\ntags: \"news hdmi2usb mjpeg\"\nlayout: post\n---<div dir=\"ltr\" style=\"text-align: left;\" trbidi=\"on\">I changed the FSM which controls the JPEG encoder yesterday. I initially went in the wrong direction as I understood the OPB protocol incorrectly. When I finally understood the problem, the implementations was of few lines. Earlier quantisation tables were written every time a new frame was loaded. Now it will change only when encoding quality changes. So it saves 1024 clock cycles per frame if encoding quality does not change. It took me several attempts to get it working. But FPS didn't change. It will probably make a difference when the fps is very high, so the clock cycle saved per frame will be significant.<br /><br />Also, I tried underclocking. I changed the clock divider of jpeg clock(freq=625Mhz/clock divider) from 7 to 11. FPS did not change for 7,8,9. But I got timeout error for 10 and 11 which I guess means FPS was too low. I honestly don't know what to make out of this.<br /><br />Also there is a bug. I have no idea about the bug. Here is the video.<br /><a href=\"https://plus.google.com/u/0/photos?pids=6018834295339420658,6018443083338911458,6018415391324052546&amp;oid=113939432707725205058&amp;pid=6018834295339420658\">&nbsp;bug video</a><br />In the video, things worked after two attempts but it can take more. .<br /><br />Today I was supposed to start changes chroma subsampling of the encoder but I guess adding UART functionality would be better as it will help me and other developers to debug easily. So I will spend the day trying to get the UART working on the board.<br /><br />Snippet:<br />Work done- Changed FSM, Played with underclocking, Studied chroma subsamling<br />Work to be done today-<br />- Implement UART on board<br /><br /><br /></div><div class=\"author\">\n  <span>\n    <i>Originally posted on <a href=\"http://ajitmathewgsoc.blogspot.com/\">TimVideo GSoC 2014: MJPEG Optimisation</a></i>\n  </span>\n</div>\n"}