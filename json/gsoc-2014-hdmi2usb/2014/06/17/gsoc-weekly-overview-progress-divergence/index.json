{"title":"[GSoC Weekly Overview]: Progress &amp; Divergence!","created_at":"2014-06-17 18:00:00 UTC","author":"Rohit (VGA Extension)","content":"<div dir=\"ltr\" style=\"text-align: left;\" trbidi=\"on\"><div dir=\"ltr\" id=\"docs-internal-guid-d43610e8-ab5c-6df5-8ee9-88a5d8751c64\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\">As the title says, this week witnessed some progress on the project and also some divergence. Actually, the divergence was related to getting the test apparatus ready for capturing VGA and confirming that it is correctly captured. A slight detour, but necessary one.</span></div><br /><h2 dir=\"ltr\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 10pt;\"><span style=\"background-color: transparent; color: black; font-family: 'Trebuchet MS'; font-size: 17px; font-style: normal; font-variant: normal; font-weight: bold; text-decoration: none; vertical-align: baseline;\">HSYNC &amp; Pixel Clock Detection</span></h2><div dir=\"ltr\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\">This was a minor part, actually left from previous week. I was able to correctly get the HSYNC and Pixel Clock from AD9984A IC with a 1024x768@60Hz test VGA signal connected to it. I tested the HSYNC using the same method as with VSYNC </span><a href=\"http://dreamsxtrinsic.blogspot.com/2014/06/gsoc-weekly-overview-fruits-of-patience.html\" style=\"text-decoration: none;\"><span style=\"background-color: transparent; color: #1155cc; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: underline; vertical-align: baseline;\">here</span></a><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\">. And, for Pixel Clock, I used a large clock divider counter(29-bit) so that its output signal will have a large time period (of ~8.2 seconds) and measured it using a stopwatch, taking different observations and finding the mean value. The value came very close to expected.</span></div><br /><h2 dir=\"ltr\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 10pt;\"><span style=\"background-color: transparent; color: black; font-family: 'Trebuchet MS'; font-size: 17px; font-style: normal; font-variant: normal; font-weight: bold; text-decoration: none; vertical-align: baseline;\">Preparing the test-setup for VGA Capture</span></h2><div dir=\"ltr\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\">As I had mentioned in my previous weekly overview post, there are two methods for testing the VGA capture. </span></div><ul style=\"margin-bottom: 0pt; margin-top: 0pt;\"><li dir=\"ltr\" style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; list-style-type: disc; text-decoration: none; vertical-align: baseline;\"><div dir=\"ltr\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\">One was to capture the VGA signal and output it to HDMI/DVI directly to see if VGA is getting captured correctly. </span></div></li><li dir=\"ltr\" style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; list-style-type: disc; text-decoration: none; vertical-align: baseline;\"><div dir=\"ltr\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\">Second method is to directly integrate the capture code into HDMI2USB code and test directly over USB. </span></div></li></ul><br /><div dir=\"ltr\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\">Selecting one option from these was a tough decision. Selecting the first one meant first getting a working HDMI code setup and hence a slight divergence from the project. Whereas, selecting the second option meant slightly high risks, even though it was lucrative since a working second option would have greatly propelled the project speed. After some thinking, I decided to go for the first option, ie, testing the capture on HDMI first then, integrating it thereafter on HDMI2USB.</span></div><br /><div dir=\"ltr\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\">I looked for various available DVI/HDMI codes and found some really good ones. But, either most of the codes didn’t utilize the SERDES &amp; TMDS signalling available on Spartan 6 or were too complex for my purpose and also required quite a few changes to them. The one I found best for my purpose was the</span><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: italic; font-variant: normal; font-weight: normal; text-decoration: underline; vertical-align: baseline;\"> Xilinx’s DVI Application Note</span><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\"> and the code. It had the added benefit of Atlys as the test hardware. So, I decided to go for it.</span></div><br /><div dir=\"ltr\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\">The Xilinx’s DVI Application Note’s code is made for testing various resolution mode namely VGA, SVGA, XGA, HDTV720P and SXGA. But, I needed only XGA for my test code. So, I had to remove most of the extraneous codes from it and also change the SPI configured DCM_CLKGEN to static configuration since I needed only a fixed clock instead of different clock for different resolutions.</span></div><br /><div dir=\"ltr\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\">Porting the code didn’t take much time but it refused to work for 6-7 times consecutively, even after me removing errors one after another. </span><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: italic; font-variant: normal; font-weight: normal; text-decoration: underline; vertical-align: baseline;\">Thankfully, I finally got the stripped down DVI code working (</span><a href=\"http://dreamsxtrinsic.blogspot.com/2014/06/gsoc-daily-log-got-dvi-app-note-working.html\" style=\"text-decoration: none;\"><span style=\"background-color: transparent; color: #1155cc; font-family: Arial; font-size: 15px; font-style: italic; font-variant: normal; font-weight: normal; text-decoration: underline; vertical-align: baseline;\">here</span></a><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: italic; font-variant: normal; font-weight: normal; text-decoration: underline; vertical-align: baseline;\">)</span><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\">.</span></div><br /><div dir=\"ltr\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\">Now, the first next task for me is to test the VGA capture on the HDMI and see if its getting captured correctly.</span></div><br /><h2 dir=\"ltr\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 10pt;\"><span style=\"background-color: transparent; color: black; font-family: 'Trebuchet MS'; font-size: 17px; font-style: normal; font-variant: normal; font-weight: bold; text-decoration: none; vertical-align: baseline;\">Upcoming Week:</span></h2><div dir=\"ltr\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\">The first job right tomorrow would be to test the VGA capture on HDMI. Then, the next actions would depend on this test’s results. If the capture is good, or if there is even a slight hint of capture working then my next target would be to get the frame displayed fully on the HDMI. The color and brightness+contrast can be ignored for time-being since they would have to be optimized using I2C by setting the relevant gain and offset registers. If frames are getting captured then it would be a very large milestone for the project. </span></div><div dir=\"ltr\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\">But, if the test results are not good or a failure, I’ll have to get back to debugging the capture code and the I2C initialization to see if there was any error in that. </span></div><div dir=\"ltr\" style=\"line-height: 1.15; margin-bottom: 0pt; margin-top: 0pt;\"><span style=\"background-color: transparent; color: black; font-family: Arial; font-size: 15px; font-style: normal; font-variant: normal; font-weight: normal; text-decoration: none; vertical-align: baseline;\">So, good test results would mean, next week I’ll be working on integrating the capture code to HDMI2USB and also getting back to the I2C VHDL cores. And, a bad test result would mean the upcoming week would be spent on debugging the codes.</span></div></div><div class=\"author\">\n  <span>\n    <i>Originally posted on <a href=\"http://dreamsxtrinsic.blogspot.com/\">Dreams eXtrinsic</a></i>\n  </span>\n</div>\n"}