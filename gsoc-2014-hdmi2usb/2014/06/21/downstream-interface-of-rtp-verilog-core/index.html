<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8"/>
  <title>TimVideos.us Planet - Developers News</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
  <meta name="description" content="News from our best developers, all news aggregated by planet."/>
  <link rel="alternate" type="application/atom+xml" title="Tim Videos Planet Feed" href="/feed.xml" />
  <link rel="canonical" href="http://planet.timvideos.us/gsoc-2014-hdmi2usb/2014/06/21/downstream-interface-of-rtp-verilog-core//">
  <link href="/css/jquery.fancybox.css?v=2.1.5" rel="stylesheet"/>
  <link href="/css/bootstrap.min.css" rel="stylesheet" />
  <link href="/css/font-awesome.min.css" rel="stylesheet" />
  <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="/css/styles.css" rel="stylesheet" />
</head>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="/js/plugins/bootstrap.min.js"></script>
<script src="/js/plugins/jquery.fancybox.pack.js?v=2.1.5"></script>
<script src="/js/plugins/jquery.plugins.js"></script>
<script src="/js/planet.js"></script>

  <body>
    <div class="wrapper">
      <div class="box">
        <div class="row">
          <div class="column col-sm-3 col-md-3 col-lg-2" id="sidebar">
  <a class="logo" href="/">
    <img src="/img/logo.png" />
    <span>PLANET</span>
  </a>
  <ul class="nav">
    <li class="active">
      <a href="/">NEWS</a>
    </li>
    <li class="">
      <a href="/people/">PEOPLE</a>
    </li>
    <li class="">
      <a href="/issues/">ISSUES</a>
    </li>
    <li class="">
      <a href="/github/">GITHUB ACTIVITIES</a>
    </li>
    <li class="">
      <a href="/stats/">GITHUB STATISTICS</a>
    </li>
  </ul>
  <ul class="nav hidden-xs" id="sidebar-footer">
    <li class="social">
      <a href="/feed.xml"><i class="fa fa-rss"></i></a>
      <a href="/feed.opml"><i class="fa fa-dot-circle-o"></i></a>
      <a href="http://www.twitter.com/TimVideosUs"><i class="fa fa-twitter"></i></a>
    </li>
    <li>
      <span>Proudly hosted by <a id="github" href="http://www.github.com">GitHub</a>
      </span>
    </li>
  </ul>
</div>
          <div class="column col-sm-9 col-md-9 col-lg-10" id="main">
            <div class="padding">
              <div class="col-sm-12">
  <div class="panel panel-default" id="featured">
    <div class="panel-body">
      
        <h4>gsoc-2014-hdmi2usb</h4>
      
      <h1>Downstream interface of RTP Verilog core</h1>
      <div class="article">
        <p class="meta description">
          Jun 21, 2014
           â€¢ Tariq (Ethernet Support)
          
        </p>
        
          <p class="tags">
            <span>Tags: </span>
            
              <span class="label label-tag">
                <a href="/tags/news">
                  news
                </a>
              </span>
            
              <span class="label label-tag">
                <a href="/tags/hdmi2usb">
                  hdmi2usb
                </a>
              </span>
            
              <span class="label label-tag">
                <a href="/tags/ethernet">
                  ethernet
                </a>
              </span>
            
          </p>
        
        <p class="share-buttons">
  <span>Share: </span>
  <span class="share-button"><a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fplanet.timvideos.us%2Fgsoc-2014-hdmi2usb%2F2014%2F06%2F21%2Fdownstream-interface-of-rtp-verilog-core%2F" target="_blank"><i class="fa fa-facebook-square fa-2x"></i></a></span>
  <span class="share-button"><a href="https://twitter.com/intent/tweet?source=http%3A%2F%2Fplanet.timvideos.us%2Fgsoc-2014-hdmi2usb%2F2014%2F06%2F21%2Fdownstream-interface-of-rtp-verilog-core%2F&text=TimVideos.us%20Downstream+interface+of+RTP+Verilog+core%20http%3A%2F%2Fplanet.timvideos.us%2Fgsoc-2014-hdmi2usb%2F2014%2F06%2F21%2Fdownstream-interface-of-rtp-verilog-core%2F" target="_blank" title="Tweet"><i class="fa fa-twitter-square fa-2x"></i></a></span>
  <span class="share-button"><a href="https://plus.google.com/share?url=http%3A%2F%2Fplanet.timvideos.us%2Fgsoc-2014-hdmi2usb%2F2014%2F06%2F21%2Fdownstream-interface-of-rtp-verilog-core%2F" target="_blank" title="Share on Google+"><i class="fa fa-google-plus-square fa-2x"></i></a></span>
</p>
        <p class="article">
          Today, i wanted to finish downstream interface of the RTP Verilog core. See <a href="https://docs.google.com/document/d/1PSjfm6eS0B3UUPJmPf7PH0tNsF7ZFKIKfPldmF3ucKY/edit?pli=1">Figure 6</a>&nbsp; of the Spec to see how the downstream interface looks like. The downstream block is the MAC (Media Access Controller). At the moment, the idea is to send RTP packets to the MAC. Once this is working, we can then insert UDP/IP/Ethernet headers and send it to the downstream interface as a realistic packet.<br /><br />I got the downstream interface working but it is lagging. What this means is that packet arrival is faster than packet departure. There are two ways to deal with this. One is to back-pressure the upstream interface until the packet is sent downstream. This means you cannot get new data from upstream interface until all the previous data has drained downstream. The other approach is to use a reasonably sized FIFO and let the arrived data fill up the FIFO. While new data arrives at the FIFO, downstream block consumes data from FIFO.<br /><br />Initially, i am going to try the first approach. Later, i can deal with the second approach.<br /><br />What i first encountered during synthesis was of course<br /><br /><span style="color: red;"><b>Synthesis Errors !!!!</b></span><br /><br /><span style="color: red;">ERROR:HDLCompiler:1401 - "/home/user/gsoc14/python_code/myhdl_code/sim_models/rtp_xilinx/rtl/packetizer.v" Line 148: Signal nxt_fifo_full in unit packetizer is connected to following multiple drivers:</span><br /><span style="color: red;">Driver 0: output signal nxt_fifo_full of instance Latch (nxt_fifo_full).</span><br /><span style="color: red;">Driver 1: output signal nxt_fifo_full of instance Multiplexer (fifo_full_fifo_full_MUX_20689).</span><br /><span style="color: red;">ERROR:HDLCompiler:1401 - "/home/user/gsoc14/python_code/myhdl_code/sim_models/rtp_xilinx/rtl/packetizer.v" Line 220: Signal nxt_send_buffer[10399] in unit packetizer is connected to following multiple drivers:</span><br /><span style="color: red;"><br /></span>So i had to rewrite RTL to make these Errors go away. I was able to do rewrite RTL as well as synthesize correctly. Here is the synthesis <a href="https://bitbucket.org/tariq786/myhdl_projs/src/46fade6c2eb1e1fae6b3a57097a9658d83c3617d/sim_models/rtp_xilinx/packetizer.syr?at=master">log file</a>. Here is the synthesized <a href="https://bitbucket.org/tariq786/myhdl_projs/src/46fade6c2eb1e1fae6b3a57097a9658d83c3617d/sim_models/rtp_xilinx/postsyn/?at=master">netlist </a>and <a href="https://bitbucket.org/tariq786/myhdl_projs/src/46fade6c2eb1e1fae6b3a57097a9658d83c3617d/sim_models/rtp_xilinx/postsyn/tb_packetizer.v?at=master">testbench</a><br /><br />Please run the <a href="https://bitbucket.org/tariq786/myhdl_projs/src/46fade6c2eb1e1fae6b3a57097a9658d83c3617d/sim_models/?at=master">code</a> and help me find bugs that you come across.<br /><br />Here is the output for a few clock cycles. The format is timestamp : 4bytes of RTP Data<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4356:80180000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4376:00000000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4416:00000501<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4436:001a0000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4456:00010000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4476:02000003<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4496:00000400<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4516:00050000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4536:06000007<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4556:00000800<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4576:00090000<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4596:0a00000b<br /><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;.</div><div><br /></div><div>I will do more testing next week.</div><br /><br /><br /><div><br /></div><div class="author">
  <span>
    <i>Originally posted on <a href="http://hdmi2ethernet.blogspot.com/">GSOC 2014</a></i>
  </span>
</div>

        </p>
      </div>
    </div>
  </div>
</div>
            </div>
            <div class="loader">
              <div class="loader-indicator"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </body>
</html>